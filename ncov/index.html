<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nCov-2019</title>
    <link rel="stylesheet" href="./css/index.css">
    <script src="./js/vue.js"></script>
    <script src="./js/jQuery/jquery-1.12.3.min.js"></script>
    <script src="./js/rem.js"></script>
</head>

<body>
    <div id="app">
        <!-- é¦–é¡µ -->
        <div v-show='tab==1'>
            <!-- å¤´éƒ¨å­ç»„ä»¶ -->
            <comptop>
                <span slot='left' class="top_left">
                  <a href="./index.html">é¦–é¡µ</a>
                </span>
            </comptop>
            <!-- é¦–é¡µæ–°é—»å­ç»„ä»¶ -->
            <compcenter></compcenter>
        </div>


        <!-- è¾Ÿè°£é¡µ -->
        <div v-show='tab==2'>
            <!-- å¤´éƒ¨å­ç»„ä»¶ -->
            <comptop>
                <span slot='left' class="top_left">
                  <a href="#">è¾Ÿè°£</a>
                </span>
            </comptop>
            <div class="two_box">
                <!-- è¾Ÿè°£æ–°é—»ä¸Šæ–¹å†…å®¹ -->
                <twocomp></twocomp>
                <!-- è¾Ÿè°£æ–°é—» -->
                <twocenter></twocenter>
            </div>
        </div>


        <!-- é˜²æŠ¤åˆè¾‘ -->
        <div v-show='tab==3'>
            <!-- å¤´éƒ¨å­ç»„ä»¶ -->
            <comptop>
                <span slot='left' class="top_left">
                  <a href="./index.html">é˜²æŠ¤</a>
                </span>
            </comptop>

            <!-- ä¸‹æ‹‰é€‰é¡¹ -->
            <streecomp></streecomp>

            <streebottom></streebottom>
        </div>


        <!-- ç–¾ç—…çŸ¥è¯† -->
        <div v-show='tab==4'>
            <!-- å¤´éƒ¨å­ç»„ä»¶ -->
            <comptop>
                <span slot='left' class="top_left">
                  <a href="./index.html">ç–¾ç—…</a>
                </span>
            </comptop>
            <lastcomp></lastcomp>
        </div>


        <!-- åº•éƒ¨å¯¼èˆªæ¡ -->
        <div class="tabbar">
            <div v-for='(item,index) in tabbar' @click='tabbars(index)' class="Tab">
                <img :src="item.img" alt="">
                <p>{{item.name}}</p>
            </div>
            <div class="none"></div>
        </div>
    </div>

    <!-- å¤´éƒ¨ -->
    <template id='comptop'>
        <div class="top">
            <slot name='left'></slot>
            <span><a href="">å¼€æºåœ°å€</a></span>
        </div>
    </template>

    <!-- é¦–é¡µæ–°é—» -->
    <template id='compcenter'>
      <div class="compcenter">
         <div v-for='(item,index) in news' class="oneitem" @click='itemnews(item.sourceUrl)'>
            <p class="title">
              <span v-if='index==0' class="icon">æœ€æ–°</span>{{item.title}}
            </p>
            <span class="test">{{item.summary}}</span>
            <p class="bx">
              <span>{{item.pubDateStr}}</span>
              <span>æ¥æº:{{item.infoSource}}</span>
            </p>
         </div>
      </div>
  </template>

    <!-- è¾Ÿè°£é¡µå­ç»„ä»¶ -->
    <template id='twocomp'>
        <div class="comp">
          <p class="two_top">
            <span class="tj"></span><b>å…¨å›½ç»Ÿè®¡</b>
            <span>{{new Date(obj.createTime).toLocaleString()}}</span>
          </p>
          <div class="yq">
            <span style="color:red">{{obj.confirmedCount}}</span>
            <span>å…¨å›½ç¡®è¯Š</span>
          </div>
          <div class="yq">
            <span style="color:#fec301">{{obj.confirmedIncr}}</span>
            <span>ç–‘ä¼¼ç—…ä¾‹</span>
          </div>
          <div class="yq"> 
            <span style="color:#55b45c">{{obj.curedCount}}</span>
            <span>æ²»æ„ˆäººæ•°</span>
          </div>
          <div class="yq">
            <span style="color:#c2c3c3">{{obj.curedIncr}}</span>
            <span>æ­»äº¡äººæ•°</span>
          </div>
          <div class="futu">
              <div style="margin-bottom: 20px;">
                  <div v-for='(item,index) in name' style="margin-bottom: 10px;">
                  <p>
                    <img src="./img/f0.png" style="width: 17px;height: 18px;margin-right: 5px;" v-if='index<3'>
                    <img src="./img/f1.png" style="width: 17px;height: 18px;margin-right: 5px;" v-else>
                    <span style="font-size: 14px;">{{item}}:</span>
                  </p>
                  <li style="font-size: 14px;">{{content[index]}}</li>
                </div>
              </div>
              <div class="ditu">
                <p class="two_top">
                  <span class="tj"></span><b>ç–«æƒ…åœ°å›¾</b>
                  <span style="float:right;font-size: 14px;color:#c2c3c3">æ•°æ®æ¥æºï¼šå›½å®¶åŠå„çœå¸‚åœ°åŒºå«å¥å§”</span>
                </p>
                <img src="http://49.232.173.220:3001/images/distribution-nationale.png" alt="">
              </div>
              <img v-for='item in obj.dailyPics' :src="item" style="width: 100%;">
              <div>
                <p class="two_top">
                  <span class="tj"></span><b>è¯Šç–—</b>
                </br>
                <a href="http://mp.weixin.qq.com/s?__biz=MzI3MzI4NDM2MQ==&mid=100017262&idx=1&sn=a594fbad05a4eab8c72d58ef74e113ea&chksm=6b2728085c50a11eaf092f2ddddc99a0927429d2bfc10e4c1e5cdf3f859ee380a7014dbbf655#rd">
                  <img src="./img/zhenliao.png" style="width: 90px;height: 90px;outline: none;">
                </a>
                </p>
              </div>
            </div>
        </div>
    </template>

    <template id="twocenter">
      <div class="twocenter">
        <p class="two_top">
          <span class="tj"></span><b>è¾Ÿè°£</b>
          <span style="float:right;font-size: 14px;color:#c2c3c3">æ¶ˆæ¯æ•°é‡ï¼š{{list.length}}</span>
        </p>
          <div class="waibu" v-for='(item,index) in list'>
            {{item.title}}
            <div class="neibu">
              <p class="txt">{{item.mainSummary}}</p>
              <p class="silde">{{item.body}}</p>
              <p class="dj">
                <span @click='zhankaiitem(index)' style="cursor: pointer;outline: none;">å±•å¼€è¯¦æƒ…</span>
                <span style="cursor: pointer;">ğŸ‘‡</span>
              </p>
            </div>
          </div>
      </div>
    </template>
    <!-- é˜²æŠ¤é€»è¾‘ -->
    <template id="streecomp">
      <div class="streecomp">
        <div class="stree_top">
          <p class="two_top">
            <span class="tj"></span><b>åœ°åŒºç»Ÿè®¡</b>
          </p>
          <p class="sispan">
            <span style="width: 22%;">åœ°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åŒº</span>
            <span>ç¡®&nbsp;&nbsp;&nbsp;è¯Š</span>
            <span>æ­»&nbsp;&nbsp;&nbsp;äº¡</span>
            <span>æ²»&nbsp;&nbsp;&nbsp;æ„ˆ</span>
          </p>
        </div>
        <hr>
        <hr>
        <div class="stree_center">
          <div v-for='(item,index) in list'>
            <li>
              <span style="width: 25%;">{{item.provinceName}}</span>
              <span>{{item.currentConfirmedCount}}</span>
              <span>{{item.deadCount}}</span>
              <span>{{item.curedCount}}</span>
              <span @click='itemcity(item.provinceName)' style="cursor: pointer;">ğŸ‘†</span>
            </li>
            <!-- å¦‚æœç‚¹å‡»ä¼ é€çš„åŸå¸‚åä¸è¯·æ±‚çš„åŸå¸‚åä¸€è‡´æ—¶æ˜¾ç¤º æ¯æ¡æ•°æ®ä¸­çš„åŸå¸‚åéƒ½ä¸åŒ è¿™æ ·èƒ½é¿å…é‡å¤,å¤šæ¬¡æ·»åŠ  -->
            <div class="citys">
             <li  v-for='(city,key) in citys'  v-if='name==item.provinceName'>
                <span style="width: 25%;">{{city.cityName}}</span>
                <span>{{city.currentConfirmedCount}}</span>
                <span>{{city.deadCount}}</span>
                <span>{{city.curedCount}}</span>
            </li>
          </div>
          </div>
        </div>
      </div>
    </template>
    <template id="streebottom">
      <div class="streebottom">
          <div v-for='item in list' class="fivediv" @click='cn(item.linkUrl)'> 
            <p>
              <b>{{item.title}}</b>
              <img :src="item.imgUrl" alt="">
            </p>
            <p>{{new Date(item.createTime).toLocaleString()}}</p>
          </div>
      </div>
    </template>
    <template id="lastcomp">
      <div class="lastcomp">
          <div v-for='(item,index) in list' class="boss" @click='mt(item.linkUrl)'>
              <div v-if='item.imgUrl!=""' class="urldiv">
                <img :src="item.imgUrl" alt="">
              </div>   
              <div :class='[index<1?"widthdiv":"salcdiv"]'> 
                <p class="titleA">{{item.title}}</p>
                <p class="titleB">{{item.description}}</p>
              </div>      
          </div>
      </div>
    </template>
    <script>
        //å¤´éƒ¨
        var comptop = {
            template: '#comptop'
        };
        //é¦–é¡µæ–°é—»
        var compcenter = {
            template: '#compcenter',
            data() {
                return {
                    news: [],
                }
            },
            mounted: function() {
                fetch('http://49.232.173.220:3001/data/getTimelineService').then((res) => {
                    res.json().then((data) => {
                        // console.log(data)
                        this.news = data;
                    })
                })
            },
            methods: {
                itemnews(url) {
                    location.href = '' + url;
                }
            },
        };
        //è¾Ÿè°£é¡µ
        let twocomp = {
            template: '#twocomp',
            data() {
                return {
                    obj: '',
                    name: [],
                    content: [],
                }
            },
            mounted: function() {
                fetch('http://49.232.173.220:3001/data/getStatisticsService').then((res) => {
                    res.json().then((data) => {
                        // console.log(data)
                        this.obj = data;
                        // console.log(this.obj)
                    })
                })
            },
            watch: {
                obj: function(newVal) {
                    //åˆ†å‰²å­—ç¬¦ä¸² å°†åå­—ä¸å†…å®¹åˆ†åˆ«åˆ†å‰²æ·»åŠ åˆ°ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ä¸­
                    let addname = (a, index) => {
                        this.name.push(a.split('ï¼š')[index])
                        this.content.push(a.split('ï¼š')[index + 1])
                    };
                    addname(this.obj.note1, 0);
                    addname(this.obj.note2, 0);
                    addname(this.obj.note3, 0);
                    addname(this.obj.remark1, 0);
                    addname(this.obj.remark2, 0);
                    addname(this.obj.remark3, 0);
                }
            },
        };
        //è¾Ÿè°£æ¶ˆæ¯
        let twocenter = {
            template: '#twocenter',
            data() {
                return {
                    list: [],
                }
            },
            mounted() {
                fetch('http://49.232.173.220:3001/data/getIndexRumorList').then((res) => {
                    res.json().then((data) => {
                        // console.log(data);
                        //å°†æ•°æ®ä¸­çš„ä¿¡æ¯ç»™æ•°ç»„list
                        this.list = data;
                    })
                })
            },
            methods: {
                zhankaiitem(index) {
                    var e = event;
                    $(e.target.parentNode.previousElementSibling).slideToggle("slow");
                    // console.log(e)
                    if (e.toElement.innerHTML == 'å±•å¼€è¯¦æƒ…') {
                        e.toElement.innerHTML = 'æ”¶èµ·è¯¦æƒ…'
                        e.target.nextElementSibling.innerHTML = 'ğŸ‘†'
                    } else {
                        e.toElement.innerHTML = 'å±•å¼€è¯¦æƒ…'
                        e.target.nextElementSibling.innerHTML = 'ğŸ‘‡'
                    }
                }
            },
        };
        let streecomp = {
            template: '#streecomp',
            data() {
                return {
                    //å­˜æ”¾å„å¤§åŸå¸‚ç–«æƒ…ä¿¡æ¯
                    list: [],
                    //å­˜æ”¾å„å¤§åŸå¸‚ä¸­çš„å¸‚åŒºç–«æƒ…ä¿¡æ¯
                    citys: false,
                    name: ''
                }
            },
            mounted: function() {
                fetch('http://49.232.173.220:3001/data/getListByCountryTypeService1').then((res) => {
                    res.json().then((data) => {
                        // console.log(data);
                        this.list = data;
                        // console.log(this.obj)
                    })
                });

            },
            methods: {
                itemcity(name) {
                    let e = event;
                    // console.log(name)
                    this.name = name;
                    new Promise((resolve, reject) => {
                        fetch('http://49.232.173.220:3001/data/getAreaStat/' + name).then((res) => {
                            res.json().then((data) => {
                                // console.log(data);
                                this.citys = data[0].cities;
                                var success = 111;
                                resolve(success)
                            })
                        });
                    });
                    if (e.toElement.innerHTML == 'ğŸ‘†' && this.citys) {
                        $(e.target.parentNode.nextElementSibling).css('display', 'block');
                        e.toElement.innerHTML = 'ğŸ‘‡';
                        $(e.target.parentNode.childNodes).filter(function(index, item) {
                            if (item.nodeType == 1) {
                                $(item)[0].style.color = 'blue';
                            }
                        });
                    } else {
                        $(e.target.parentNode.nextElementSibling).css('display', 'none');
                        e.toElement.innerHTML = 'ğŸ‘†';
                        $(e.target.parentNode.childNodes).filter(function(index, item) {
                            if (item.nodeType == 1) {
                                $(item)[0].style.color = '#000000';
                            }
                        });
                    }
                }
            },
        };
        let streebottom = {
            template: '#streebottom',
            data() {
                return {
                    list: [],
                }
            },
            mounted() {
                fetch('http://49.232.173.220:3001/data/getIndexRecommendList').then((res) => {
                    res.json().then((data) => {
                        console.log(data);
                        this.list = data;
                        // console.log(this.obj)
                    })
                });
            },
            methods: {
                cn(url) {
                    location.href = '' + url;
                }
            },
        };
        let lastcomp = {
            template: '#lastcomp',
            data() {
                return {
                    list: [],
                }
            },
            mounted: function() {
                fetch('http://49.232.173.220:3001/data/getWikiList').then((res) => {
                    res.json().then((data) => {
                        // console.log('æœ€æ–°çŸ¥è¯†ç™¾ç§‘', data);
                        this.list = data.result;
                    })
                })
            },
            methods: {
                mt(url) {
                    location.href = '' + url;
                }
            }
        }
        new Vue({
            el: '#app',
            data: {
                tab: 1,
                tabbar: [{
                    img: './img/shouye1.png',
                    name: 'é¦–é¡µ'
                }, {
                    img: './img/piyao.png',
                    name: 'è¾Ÿè°£'
                }, {
                    img: './img/fanghu.png',
                    name: 'é˜²æŠ¤é€»è¾‘'
                }, {
                    img: './img/zhishi.png',
                    name: 'ç–¾ç—…çŸ¥è¯†'
                }],
            },
            methods: {
                tabbars(index) {
                    this.tab = index + 1;
                    // console.log(this.tab)
                    var img = ['./img/shouye.png', './img/piyao.png', './img/fanghu.png', './img/zhishi.png'];
                    var img1 = ['./img/shouye1.png', './img/piyao1.png', './img/fanghu1.png', './img/zhishi1.png'];
                    this.tabbar.forEach((item, index) => {
                        item.img = img[index]
                    });
                    this.tabbar[index].img = img1[index];
                }
            },
            components: {
                comptop,
                compcenter,
                twocomp,
                twocenter,
                streecomp,
                streebottom,
                lastcomp,
            }
        })
    </script>
    <script src="./js/index.js"></script>
</body>

</html>